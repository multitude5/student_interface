#include<stdio.h>
#include<string.h>
#include<conio.h>
int main()
{
    char roll_no[15] = "sp19-bcs-001";
    char roll_no_f[25];
    char subject_f[60];
    int t_students,t_subjects;
    FILE *ptr;
    ptr = fopen("data.txt","r+");
    if ( ptr == NULL)
    {
        printf("ERROR");
    }
    fscanf(ptr,"%d %d",&t_students,&t_subjects);
    rewind(ptr);
    int position = 39;
    int subject_position= 60;
    int possibilities = t_students * t_subjects;
    int i = 0,z = 1,choice;

    printf("Enter the subject no you want to check : \n");

    while (i <= possibilities)
    {
        position += 281 ;
        fseek(ptr,position,0);
        fgets(roll_no_f,13,ptr);
        i++;
        if (!strcmp(roll_no,roll_no_f))
        {
            fseek(ptr,8,1);
            fgets(subject_f,40,ptr);
            printf("%d)%s\n",z,subject_f);
            z++;
        }
    }
    scanf("%d",&choice);

    /* to get roll no in int */
    char *token = strtok(roll_no,"-");
    token = strtok(NULL,"-");
    token = strtok(NULL,"-");

    int roll_no_tok = atoi(token);

    /* Line were t*/
    int line = t_students*(choice-1)+roll_no_tok;

    /* Position of student in file */
    int position_3 = line * 281 ;
    rewind(ptr);
    fseek(ptr,position_3,0);

    /* to get quiz data from file */

    int position_quiz = position_3 + 130;
    char quiz[5];
    for(int outer = 1 ; outer <= 4 ; outer++)
    {
        fseek(ptr,position_quiz,0);
        fgets(quiz,3,ptr);
        position_quiz += 8;
        printf("quiz%d :%s\n",outer,quiz);
    }

    /* To print assignments data */

    int position_assignment = position_3 + 162 ;
    char assignment[5];
    for ( int inner = 1 ; inner <= 4 ; inner++ )
    {
        fseek(ptr,position_assignment,0);
        fgets(assignment,3,ptr);
        position_assignment += 8;
        printf("Assignment%d :%s\n",inner,assignment);
    }

    /* To print sessionals and terminals dara */

    int position_sessionals = position_3 + 194 ;
    char sessional[5];
    for ( int s = 1 ; s <= 3 ; s++ )
    {
        fseek(ptr,position_sessionals,0);
        fgets(sessional,3,ptr);
        position_sessionals += 8;
        if ( s == 3 )
        {
            printf("Terminal marks : %s\n",sessional);
            break;
        }
        printf("Sessiona%d Marks : %s\n",s,sessional);
    }


}
